<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EXCELlent Intermediate Accounting – Quizzes Hub</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    nav select, nav button { margin-right: 10px; padding: 5px; }
    .hidden { display: none; }
    .quiz-block { margin-bottom: 20px; }
    .correct { color: green; }
    .incorrect { color: red; }
    .excel-image { max-width: 100%; height: auto; margin-top: 10px; }
    .celebration-banner { background: #f0f8ff; padding: 20px; border: 2px solid #00f; margin-bottom: 20px; }
    .progress-tracker { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <header>
    <h1>EXCELlent Intermediate Accounting – Quizzes Hub</h1>
  </header>

  <main>
    <nav>
      <select id="volumeSelect">
        <option value="">Select Volume</option>
        <option value="vol1">Volume 1</option>
        <option value="vol2">Volume 2</option>
      </select>

      <select id="chapterSelect" disabled>
        <option value="">Select Chapter</option>
      </select>

      <select id="topicSelect" disabled>
        <option value="">Select Topic</option>
      </select>

      <select id="typeSelect" disabled>
        <option value="">Select Type</option>
      </select>

      <button id="submitBtn" disabled>Submit</button>
      <button id="resetBtn">Reset</button>
    </nav>

    <section id="scoreDisplay" class="hidden">
      <p>Raw Score: <span id="rawScore">0</span></p>
      <p>Percentage: <span id="percentageScore">0%</span></p>
    </section>

    <section id="quizContainer"></section>
  </main>

  <footer>
    <p>&copy; 2025 EXCELlent Intermediate Accounting</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const volumeSelect = document.getElementById("volumeSelect");
      const chapterSelect = document.getElementById("chapterSelect");
      const topicSelect = document.getElementById("topicSelect");
      const typeSelect = document.getElementById("typeSelect");
      const submitBtn = document.getElementById("submitBtn");
      const resetBtn = document.getElementById("resetBtn");
      const quizContainer = document.getElementById("quizContainer");
      const scoreDisplay = document.getElementById("scoreDisplay");
      const rawScore = document.getElementById("rawScore");
      const percentageScore = document.getElementById("percentageScore");

      let score = 0;
      let totalQuestions = 0;

      function adjustDropdownWidth(selectElement) {
        const temp = document.createElement("select");
        const option = document.createElement("option");
        option.textContent = selectElement.options[selectElement.selectedIndex]?.text || "";
        temp.style.visibility = "hidden";
        temp.style.position = "absolute";
        temp.style.font = getComputedStyle(selectElement).font;
        temp.appendChild(option);
        document.body.appendChild(temp);
        selectElement.style.width = `${temp.offsetWidth + 24}px`;
        document.body.removeChild(temp);
      }

      [volumeSelect, chapterSelect, topicSelect, typeSelect].forEach(select => {
        select.addEventListener("change", () => adjustDropdownWidth(select));
      });

      volumeSelect.addEventListener("change", () => {
        const vol = volumeSelect.value;
        chapterSelect.innerHTML = `<option value="">Select Chapter</option>`;
        topicSelect.innerHTML = `<option value="">Select Topic</option>`;
        typeSelect.innerHTML = `<option value="">Select Type</option>`;
        chapterSelect.disabled = true;
        topicSelect.disabled = true;
        typeSelect.disabled = true;
        submitBtn.disabled = true;

        if (vol && quizData[vol]) {
          chapterSelect.disabled = false;
          const chapters = quizData[vol].chapters;
          for (let chap in chapters) {
            const option = document.createElement("option");
            option.value = chap;
            option.textContent = chap.replace("chap", "Chapter ");
            chapterSelect.appendChild(option);
          }
        }
      });

      chapterSelect.addEventListener("change", () => {
        const vol = volumeSelect.value;
        const chap = chapterSelect.value;
        topicSelect.innerHTML = `<option value="">Select Topic</option>`;
        typeSelect.innerHTML = `<option value="">Select Type</option>`;
        topicSelect.disabled = true;
        typeSelect.disabled = true;
        submitBtn.disabled = true;

        if (chap && quizData[vol]?.chapters?.[chap]) {
          topicSelect.disabled = false;
          const topics = quizData[vol].chapters[chap].topics;
          for (let topic in topics) {
            const option = document.createElement("option");
            option.value = topic;
            option.textContent = topic;
            topicSelect.appendChild(option);
          }
        }
      });

      topicSelect.addEventListener("change", () => {
        const vol = volumeSelect.value;
        const chap = chapterSelect.value;
        const topic = topicSelect.value;
        typeSelect.innerHTML = `<option value="">Select Type</option>`;
        typeSelect.disabled = true;
        submitBtn.disabled = true;

        if (topic && quizData[vol]?.chapters?.[chap]?.topics?.[topic]) {
          typeSelect.disabled = false;
          const types = quizData[vol].chapters[chap].topics[topic].types;
          types.forEach(type => {
            const option = document.createElement("option");
            option.value = type;
            option.textContent = type;
            typeSelect.appendChild(option);
          });
          adjustDropdownWidth(typeSelect);
        }
      });

      typeSelect.addEventListener("change", () => {
        submitBtn.disabled = !typeSelect.value;
      });

      resetBtn.addEventListener("click", () => {
        volumeSelect.value = "";
        chapterSelect.innerHTML = `<option value="">Select Chapter</option>`;
        topicSelect.innerHTML = `<option value="">Select Topic</option>`;
        typeSelect.innerHTML = `<option value="">Select Type</option>`;
        chapterSelect.disabled = true;
        topicSelect.disabled = true;
        typeSelect.disabled = true;
        submitBtn.disabled = true;
        quizContainer.innerHTML = "";
        scoreDisplay.classList.add("hidden");
        rawScore.textContent = "0";
        percentageScore.textContent = "0%";
        score = 0;
        totalQuestions = 0;
      });

      console.log("✅ DOMContentLoaded block closed successfully");
    });
  </script>
</body>
</html>
